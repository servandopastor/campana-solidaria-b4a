<!DOCTYPE html>
<html lang="es">
<head>
    <!-- ... (código del head sin cambios) ... -->
</head>
<body class="bg-gray-100 p-8">
    <!-- ... (estructura HTML sin cambios) ... -->

    <script>
        const GITHUB_TOKEN = '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';
        const REPO_OWNER = 'servandopastor';
        const REPO_NAME = 'campana-solidaria-b4a';

        async function fetchGitHubFile(path) {
            const response = await fetch(`https://api.github.com/repos/${REPO_OWNER}/${REPO_NAME}/contents/${path}`, {
                headers: {
                    'Authorization': `token ${GITHUB_TOKEN}`,
                    'Accept': 'application/vnd.github.v3+json'
                }
            });
            const data = await response.json();
            return JSON.parse(atob(data.content));
        }

        async function updateGitHubFile(path, content) {
            const response = await fetch(`https://api.github.com/repos/${REPO_OWNER}/${REPO_NAME}/contents/${path}`, {
                method: 'PUT',
                headers: {
                    'Authorization': `token ${GITHUB_TOKEN}`,
                    'Accept': 'application/vnd.github.v3+json',
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    message: 'Actualizar datos',
                    content: btoa(JSON.stringify(content)),
                    sha: await getFileSHA(path)
                })
            });
            return response.ok;
        }

        async function getFileSHA(path) {
            const response = await fetch(`https://api.github.com/repos/${REPO_OWNER}/${REPO_NAME}/contents/${path}`, {
                headers: {
                    'Authorization': `token ${GITHUB_TOKEN}`,
                    'Accept': 'application/vnd.github.v3+json'
                }
            });
            const data = await response.json();
            return data.sha;
        }

        async function loadData() {
            try {
                productos = await fetchGitHubFile('data/productos.json');
                familias = await fetchGitHubFile('data/familias.json');
                carro = await fetchGitHubFile('data/carro.json');
                bodega = await fetchGitHubFile('data/bodega.json');
                updateUI();
            } catch (error) {
                console.error('Error loading data:', error);
            }
        }

        async function saveData() {
            try {
                await updateGitHubFile('data/productos.json', productos);
                await updateGitHubFile('data/carro.json', carro);
                await updateGitHubFile('data/bodega.json', bodega);
            } catch (error) {
                console.error('Error saving data:', error);
            }
        }

        // Actualiza las funciones existentes para usar saveData()
        function addToCart(productId) {
            // ... (código existente) ...
            saveData();
        }

        function removeFromCart(productId) {
            // ... (código existente) ...
            saveData();
        }

        document.getElementById('confirmarCooperacion').addEventListener('click', async () => {
            // ... (código existente) ...
            await saveData();
        });

        // ... (resto del código JavaScript sin cambios) ...

    </script>
</body>
</html>
